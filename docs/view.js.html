<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: view.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: view.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>
/**
 * This file controls the main front end view
 * of the app.
 *
 *
 * @exports view
 */
var helpers = require( './lib/helpers.js' ),
    model = require( './model.js' );


/**
 * Main view object
 *
 * @namespace
 */
var view = {
  init: function() {
    view.loadMainHeader();
  },

  currentPost: '',

  /**
   * Listener to disable view navigation while
   * editor is open.
   *
   */
  listenDisableViewLinks: function() {
    var links = helpers.getViewLinks();
    for ( var i = 0, len = links.length; i &lt; len; i++ ) {
      // Add listener to deactivate main nav
      links[i].addEventListener('click', view.disableNav, false);
    }
  },

  /**
   * Listener to disable links in the view while the
   * editor is open.
   *
   */
  listenEnableViewLinks: function() {
    var links = helpers.getViewLinks();
    for ( var i = 0, len = links.length; i &lt; len; i++ ) {
      // Add listener to deactivate main nav
      links[i].removeEventListener('click', view.disableNav, false);
    }
  },


  /**
   * Sets the current post and updates the view
   *
   * @param post {object} The new current post
   */
   setCurrentPost: function( post ) {
     view.currentPost = post;
     view.update();
   },

  /**
   * Updates the view based on current post
   *
   */
  update: function() {
    view.updateTitle( view.currentPost.title );
    view.updateContent( view.currentPost.content );

    view.removeBlogPosts();
    if ( 'blog' === view.currentPost.slug ) {
      // Append blog posts to blog page
      view.loadBlogPosts();
    }
  },

  /**
   * Loads the main header based on settings data in local store.
   *
   */
  loadMainHeader: function() {
    // Get site name and description from store
    var siteName = model.getPostBySlug( 'site-name', 'settings' ),
        siteDescription = model.getPostBySlug(
          'site-description',
          'settings'
        );
    view.updateSiteName( siteName.content );
    view.updateSiteDescription( siteDescription.content );
  },

  /**
   * Helper function to update to post content in the view.
   *
   * @param content {string} The site name to display
   */
  updateSiteName: function( content ) {
    var siteName = helpers.getSiteName();
    siteName.innerHTML = content;
  },

  /**
   * Helper function to update to the site description in the view.
   *
   * @param content {string} The site description to display
   */
  updateSiteDescription: function( content ) {
    var siteDescription = helpers.getSiteDescription();
    siteDescription.innerHTML = content;
  },

  /**
   * Helper function to update main page title in the view.
   *
   * @param title {string} The title to display
   */
  updateTitle: function(title) {
    var titleEl = document.getElementById( 'pageTitle' );
    titleEl.innerHTML = title;
  },

  /**
   * Helper function to update main page content in the view.
   *
   * @param content {string} The content to display
   */
  updateContent: function(content) {
    var contentEl = document.getElementById( 'pageContent' );
    contentEl.innerHTML = content;
  },

  /**
   * Helper function to clear title and content
   * in the main view
   *
   */
  clearContent: function() {
    var titleEl = document.getElementById( 'pageTitle' ),
        contentEl = document.getElementById( 'pageContent' );

    titleEl.innerHTML = '';
    contentEl.innerHTML = '';
  },

  /**
   * Gets blog posts and appends them to the page.
   *
   */
  loadBlogPosts: function() {
    var posts = model.getPostsByType( 'posts' ),
        postsMarkup = document.createElement( 'section' ),
        primaryContentEL;

    postsMarkup.id = 'blogPosts';
    // Get markup for each post
    for ( var i = 0, max = posts.length; i &lt; max; i++ ) {
      postsMarkup.appendChild( helpers.createPostMarkup( posts[i] ) );
    }
    primaryContentEL = helpers.getPrimaryContentEl();
    // Append posts to page
    primaryContentEL.appendChild( postsMarkup );
  },

  /**
   * Remove blog posts from page
   *
   */
  removeBlogPosts: function(){
    var blogPost = document.getElementById( 'blogPosts' );
    if( blogPost )  {
      blogPost.remove();
    }
  },

  /**
   * Prevents main nav from working. Used when editor is open.
   *
   */
  disableNav: function(){
    event.preventDefault();
  }
};
module.exports = view;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-editor.html">editor</a></li><li><a href="module-model.html">model</a></li><li><a href="module-router.html">router</a></li><li><a href="module-view.html">view</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-editor-editor.html">editor</a></li><li><a href="module-model-model.html">model</a></li><li><a href="module-router-router.html">router</a></li><li><a href="module-view-view.html">view</a></li><li><a href="vanillaPress.html">vanillaPress</a></li></ul><h3>Global</h3><ul><li><a href="global.html#jsonData">jsonData</a></li><li><a href="global.html#model">model</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Thu Feb 25 2016 14:52:04 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
